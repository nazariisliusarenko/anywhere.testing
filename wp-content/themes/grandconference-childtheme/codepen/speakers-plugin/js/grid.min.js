var $event=$.event,$special,resizeTimeout;$special=$event.special.debouncedresize={setup:function(){$(this).on("resize",$special.handler)},teardown:function(){$(this).off("resize",$special.handler)},handler:function(i,e){var t=this,s=arguments,n=function(){i.type="debouncedresize",$event.dispatch.apply(t,s)};resizeTimeout&&clearTimeout(resizeTimeout),e?n():resizeTimeout=setTimeout(n,$special.threshold)},threshold:250};var BLANK="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";$.fn.imagesLoaded=function(i){function e(){var e=$(r),t=$(d);n&&(d.length?n.reject(o,e,t):n.resolve(o)),$.isFunction(i)&&i.call(s,o,e,t)}function t(i,t){i.src!==BLANK&&-1===$.inArray(i,h)&&(h.push(i),t?d.push(i):r.push(i),$.data(i,"imagesLoaded",{isBroken:t,src:i.src}),a&&n.notifyWith($(i),[t,o,$(r),$(d)]),o.length===h.length&&(setTimeout(e),o.unbind(".imagesLoaded")))}var s=this,n=$.isFunction($.Deferred)?$.Deferred():0,a=$.isFunction(n.notify),o=s.find("img").add(s.filter("img")),h=[],r=[],d=[];return $.isPlainObject(i)&&$.each(i,function(e,t){"callback"===e?i=t:n&&n[e](t)}),o.length?o.bind("load.imagesLoaded error.imagesLoaded",function(i){t(i.target,"error"===i.type)}).each(function(i,e){var s=e.src,n=$.data(e,"imagesLoaded");return n&&n.src===s?void t(e,n.isBroken):e.complete&&void 0!==e.naturalWidth?void t(e,0===e.naturalWidth||0===e.naturalHeight):void((e.readyState||e.complete)&&(e.src=BLANK,e.src=s))}):e(),n?n.promise(s):s};var Grid=function(){function i(i){A=$.extend(!0,{},A,i),d.imagesLoaded(function(){e(!0),n(),t()})}function e(i){c.each(function(){var e=$(this);e.data("offsetTop",e.offset().top),i&&e.data("height",e.height())})}function t(){c.on("click","span.og-close",function(){return o(),s(),!1}).children("a").on("click",function(i){s();var e=$(this).parent();return e.find(".fa").removeClass("fa-plus"),e.find(".fa").addClass("fa-minus"),l===e.index()?o():a(e),!1}),g.on("debouncedresize",function(){f=0,p=-1,e(),n(),void 0!==$.data(this,"preview")&&o()})}function s(){$(".fa").removeClass("fa-minus"),$(".fa").addClass("fa-plus")}function n(){r={width:g.width(),height:g.height()}}function a(i){var e=$.data(this,"preview"),t=i.data("offsetTop");if(f=0,void 0!==e){if(p===t)return e.update(i),!1;t>p&&(f=e.height),o()}p=t,e=$.data(this,"preview",new h(i)),e.open()}function o(){l=-1,$.data(this,"preview").close(),$.removeData(this,"preview")}function h(i){this.$item=i,this.expandedIdx=this.$item.index(),this.create(),this.update()}var r,d=$("#og-grid"),c=d.children("li"),l=-1,p=-1,f=0,g=$(window),u=$("html, body"),m={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"},v=m[Modernizr.prefixed("transition")],w=Modernizr.csstransitions,A={minHeight:500,speed:350,easing:"ease"};return h.prototype={create:function(){this.$title=$("<h3></h3>"),this.$description=$("<p></p>"),this.$href=$('<a href="#">Visit website</a>'),this.$details=$('<div class="og-details"></div>').append(this.$title,this.$description,this.$href),this.$loading=$('<div class="og-loading"></div>'),this.$fullimage=$('<div class="og-fullimg"></div>').append(this.$loading),this.$closePreview=$('<span class="og-close"></span>'),this.$previewInner=$('<div class="og-expander-inner"></div>').append(this.$fullimage),this.$previewEl=$('<div class="og-expander"></div>').append(this.$closePreview,this.$previewInner),this.$item.append(this.getEl()),w&&this.setTransition()},update:function(i){if(i&&(this.$item=i),-1!==l){c.eq(l).removeClass("og-expanded"),this.$item.addClass("og-expanded"),this.positionPreview()}l=this.$item.index(),$.get("subpage.html",function(i){$(".og-expander-inner").html(i)})},open:function(){setTimeout($.proxy(function(){this.setHeights(),this.positionPreview()},this),25)},close:function(){var i=this,e=function(){w&&$(this).off(v),i.$item.removeClass("og-expanded"),i.$previewEl.remove()};return setTimeout($.proxy(function(){void 0!==this.$largeImg&&this.$largeImg.fadeOut("fast"),this.$previewEl.css("height",0);var i=c.eq(this.expandedIdx);i.css("height",i.data("height")).on(v,e),w||e.call()},this),25),!1},calcHeight:function(){var i=r.height-this.$item.data("height")-10,e=r.height;i<A.minHeight&&(i=A.minHeight,e=A.minHeight+this.$item.data("height")+10),this.height=i,this.itemHeight=e},setHeights:function(){var i=this,e=function(){w&&i.$item.off(v),i.$item.addClass("og-expanded")};this.calcHeight(),this.$previewEl.css("height",this.height),this.$item.css("height",this.itemHeight).on(v,e),w||e.call()},positionPreview:function(){var i=this.$item.data("offsetTop"),e=this.$previewEl.offset().top-f,t=this.height+this.$item.data("height")+10<=r.height?i:this.height<r.height?e-(r.height-this.height):e;u.animate({scrollTop:t},A.speed)},setTransition:function(){this.$previewEl.css("transition","height "+A.speed+"ms "+A.easing),this.$item.css("transition","height "+A.speed+"ms "+A.easing)},getEl:function(){return this.$previewEl}},{init:i}}();
//# sourceMappingURL=grid.min.js.map
