{"version":3,"sources":["js/grid.js"],"names":["$event","$","event","$special","resizeTimeout","special","debouncedresize","setup","this","on","handler","teardown","off","execAsap","context","args","arguments","dispatch","type","apply","clearTimeout","setTimeout","threshold","BLANK","fn","imagesLoaded","callback","doneLoading","$proper","proper","$broken","broken","deferred","length","reject","$images","resolve","isFunction","call","$this","imgLoaded","img","isBroken","src","inArray","loaded","push","data","hasNotify","notifyWith","unbind","Deferred","notify","find","add","filter","isPlainObject","each","key","value","bind","target","i","el","cached","complete","undefined","naturalWidth","naturalHeight","readyState","promise","Grid","init","config","settings","extend","$grid","saveItemInfo","getWinSize","initEvents","saveheight","$items","$item","offset","top","height","hidePreview","resetPlus","children","e","parent","removeClass","addClass","current","index","showPreview","$window","scrollExtra","previewPos","winsize","width","preview","position","update","Preview","open","close","removeData","expandedIdx","create","window","$body","transEndEventNames","WebkitTransition","MozTransition","OTransition","msTransition","transition","transEndEventName","Modernizr","prefixed","support","csstransitions","minHeight","speed","easing","prototype","$title","$description","$href","$details","append","$loading","$fullimage","$closePreview","$previewInner","$previewEl","getEl","setTransition","eq","positionPreview","get","html","proxy","setHeights","self","onEndFn","remove","$largeImg","fadeOut","css","$expandedItem","calcHeight","heightPreview","itemHeight","previewOffsetT","scrollVal","animate","scrollTop"],"mappings":"AASA,GAAIA,QAASC,EAAEC,MACfC,SACAC,aAEAD,UAAWH,OAAOK,QAAQC,iBACzBC,MAAO,WACNN,EAAGO,MAAOC,GAAI,SAAUN,SAASO,UAElCC,SAAU,WACTV,EAAGO,MAAOI,IAAK,SAAUT,SAASO,UAEnCA,QAAS,SAAUR,EAAOW,GAEzB,GAAIC,GAAUN,KACbO,EAAOC,UACPC,EAAW,WAEVf,EAAMgB,KAAO,kBACblB,OAAOiB,SAASE,MAAOL,EAASC,GAG7BX,gBACJgB,aAAchB,eAGfS,EACCI,IACAb,cAAgBiB,WAAYJ,EAAUd,SAASmB,YAEjDA,UAAW,IAiBZ,IAAIC,OAAQ,wEAEZtB,GAAEuB,GAAGC,aAAe,SAAUC,GAoB7B,QAASC,KACR,GAAIC,GAAU3B,EAAE4B,GACfC,EAAU7B,EAAE8B,EAERC,KACCD,EAAOE,OACXD,EAASE,OAAQC,EAASP,EAASE,GAEnCE,EAASI,QAASD,IAIflC,EAAEoC,WAAYX,IAClBA,EAASY,KAAMC,EAAOJ,EAASP,EAASE,GAI1C,QAASU,GAAWC,EAAKC,GAEnBD,EAAIE,MAAQpB,QAAuC,IAA9BtB,EAAE2C,QAASH,EAAKI,KAK1CA,EAAOC,KAAML,GAGRC,EACJX,EAAOe,KAAML,GAEbZ,EAAOiB,KAAML,GAIdxC,EAAE8C,KAAMN,EAAK,gBAAkBC,SAAUA,EAAUC,IAAKF,EAAIE,MAGvDK,GACJhB,EAASiB,WAAYhD,EAAEwC,IAAQC,EAAUP,EAASlC,EAAE4B,GAAS5B,EAAE8B,KAI3DI,EAAQF,SAAWY,EAAOZ,SAC9BZ,WAAYM,GACZQ,EAAQe,OAAQ,mBA/DlB,GAAIX,GAAQ/B,KACXwB,EAAW/B,EAAEoC,WAAWpC,EAAEkD,UAAYlD,EAAEkD,WAAa,EACrDH,EAAY/C,EAAEoC,WAAWL,EAASoB,QAClCjB,EAAUI,EAAMc,KAAK,OAAOC,IAAKf,EAAMgB,OAAO,QAC9CV,KACAhB,KACAE,IAgGD,OA7FI9B,GAAEuD,cAAc9B,IACnBzB,EAAEwD,KAAK/B,EAAU,SAAUgC,EAAKC,GACnB,aAARD,EACHhC,EAAWiC,EACD3B,GACVA,EAAS0B,GAAKC,KAsDXxB,EAAQF,OAGbE,EAAQyB,KAAM,uCAAwC,SAAU1D,GAE/DsC,EAAWtC,EAAM2D,OAAuB,UAAf3D,EAAMgB,QAC7BuC,KAAM,SAAUK,EAAGC,GACrB,GAAIpB,GAAMoB,EAAGpB,IAITqB,EAAS/D,EAAE8C,KAAMgB,EAAI,eACzB,OAAKC,IAAUA,EAAOrB,MAAQA,MAC7BH,GAAWuB,EAAIC,EAAOtB,UAMlBqB,EAAGE,cAAgCC,KAApBH,EAAGI,iBACtB3B,GAAWuB,EAAwB,IAApBA,EAAGI,cAA2C,IAArBJ,EAAGK,qBAOvCL,EAAGM,YAAcN,EAAGE,YACxBF,EAAGpB,IAAMpB,MACTwC,EAAGpB,IAAMA,MA5BXhB,IAiCMK,EAAWA,EAASsC,QAAS/B,GAAUA,EAG/C,IAAIgC,MAAO,WAmCV,QAASC,GAAMC,GAGdC,EAAWzE,EAAE0E,QAAQ,KAAUD,EAAUD,GAGzCG,EAAMnD,aAAc,WAGnBoD,GAAc,GAEdC,IAEAC,MAOF,QAASF,GAAcG,GACtBC,EAAOxB,KAAM,WACZ,GAAIyB,GAAQjF,EAAGO,KACf0E,GAAMnC,KAAM,YAAamC,EAAMC,SAASC,KACpCJ,GACHE,EAAMnC,KAAM,SAAUmC,EAAMG,YAK/B,QAASN,KAKRE,EAAOxE,GAAI,QAAS,gBAAiB,WAGpC,MAFA6E,KACGC,KACI,IACJC,SAAU,KAAM/E,GAAI,QAAS,SAASgF,GACtCF,GACH,IAAIL,GAAQjF,EAAGO,MAAOkF,QAMtB,OAJGR,GAAM7B,KAAK,OAAOsC,YAAY,WAC9BT,EAAM7B,KAAK,OAAOuC,SAAS,YAE9BC,IAAYX,EAAMY,QAAUR,IAAgBS,EAAab,IAClD,IAMRc,EAAQvF,GAAI,kBAAmB,WAE9BwF,EAAc,EACdC,GAAc,EAEdrB,IACAC,QAEsB,KADR7E,EAAE8C,KAAMvC,KAAM,YAE3B8E,MAQF,QAASC,KACPtF,EAAE,OAAO0F,YAAY,YACrB1F,EAAE,OAAO2F,SAAS,WAErB,QAASd,KACRqB,GAAYC,MAAQJ,EAAQI,QAASf,OAASW,EAAQX,UAGvD,QAASU,GAAab,GAErB,GAAImB,GAAUpG,EAAE8C,KAAMvC,KAAM,WAE3B8F,EAAWpB,EAAMnC,KAAM,YAKxB,IAHAkD,EAAc,MAGQ,KAAXI,EAAyB,CAGnC,GAAIH,IAAeI,EAUlB,MADAD,GAAQE,OAAQrB,IACT,CARHoB,GAAWJ,IACdD,EAAcI,EAAQhB,QAEvBC,IAWFY,EAAaI,EAEbD,EAAUpG,EAAE8C,KAAMvC,KAAM,UAAW,GAAIgG,GAAStB,IAEhDmB,EAAQI,OAIT,QAASnB,KACRO,GAAW,EACG5F,EAAE8C,KAAMvC,KAAM,WACpBkG,QACRzG,EAAE0G,WAAYnG,KAAM,WAIrB,QAASgG,GAAStB,GACjB1E,KAAK0E,MAAQA,EACb1E,KAAKoG,YAAcpG,KAAK0E,MAAMY,QAC9BtF,KAAKqG,SACLrG,KAAK+F,SA9JN,GAYwBJ,GAZpBvB,EAAQ3E,EAAG,YAEdgF,EAASL,EAAMY,SAAU,MAEzBK,GAAW,EAGXK,GAAc,EAEdD,EAAc,EAGdD,EAAU/F,EAAG6G,QACbC,EAAQ9G,EAAG,cAEX+G,GACCC,iBAAqB,sBACrBC,cAAkB,gBAClBC,YAAgB,iBAChBC,aAAiB,kBACjBC,WAAe,iBAEhBC,EAAoBN,EAAoBO,UAAUC,SAAU,eAE5DC,EAAUF,UAAUG,eAEpBhD,GACCiD,UAAY,IACZC,MAAQ,IACRC,OAAS,OAgTX,OA5KArB,GAAQsB,WACPjB,OAAS,WAERrG,KAAKuH,OAAS9H,EAAG,aACjBO,KAAKwH,aAAe/H,EAAG,WACvBO,KAAKyH,MAAQhI,EAAG,iCAChBO,KAAK0H,SAAWjI,EAAG,kCAAmCkI,OAAQ3H,KAAKuH,OAAQvH,KAAKwH,aAAcxH,KAAKyH,OACnGzH,KAAK4H,SAAWnI,EAAG,kCACnBO,KAAK6H,WAAapI,EAAG,kCAAmCkI,OAAQ3H,KAAK4H,UACrE5H,KAAK8H,cAAgBrI,EAAG,kCACxBO,KAAK+H,cAAgBtI,EAAG,yCAA0CkI,OAAO3H,KAAK6H,YAC9E7H,KAAKgI,WAAavI,EAAG,mCAAoCkI,OAAQ3H,KAAK8H,cAAc9H,KAAK+H,eAEzF/H,KAAK0E,MAAMiD,OAAQ3H,KAAKiI,SAEpBhB,GACHjH,KAAKkI,iBAGPnC,OAAS,SAAUrB,GAOlB,GALIA,IACH1E,KAAK0E,MAAQA,IAIG,IAAbW,EAAiB,CACDZ,EAAO0D,GAAI9C,GACjBF,YAAa,eAC1BnF,KAAK0E,MAAMU,SAAU,eAErBpF,KAAKoI,kBAIN/C,EAAUrF,KAAK0E,MAAMY,QAElB7F,EAAE4I,IAAK,eAAgB,SAAU9F,GAC/B9C,EAAG,sBAAuB6I,KAAM/F,MAuCtC0D,KAAO,WAENpF,WAAYpB,EAAE8I,MAAO,WAEpBvI,KAAKwI,aAELxI,KAAKoI,mBACHpI,MAAQ,KAGZkG,MAAQ,WAEP,GAAIuC,GAAOzI,KACV0I,EAAU,WACLzB,GACHxH,EAAGO,MAAOI,IAAK0G,GAEhB2B,EAAK/D,MAAMS,YAAa,eACxBsD,EAAKT,WAAWW,SAmBlB,OAhBA9H,YAAYpB,EAAE8I,MAAO,eAEU,KAAnBvI,KAAK4I,WACf5I,KAAK4I,UAAUC,QAAS,QAEzB7I,KAAKgI,WAAWc,IAAK,SAAU,EAE/B,IAAIC,GAAgBtE,EAAO0D,GAAInI,KAAKoG,YACpC2C,GAAcD,IAAK,SAAUC,EAAcxG,KAAM,WAAatC,GAAI6G,EAAmB4B,GAEhFzB,GACJyB,EAAQ5G,QAGP9B,MAAQ,KAEJ,GAGRgJ,WAAa,WAEZ,GAAIC,GAAgBtD,EAAQd,OAAS7E,KAAK0E,MAAMnC,KAAM,UA7QtC,GA8Qf2G,EAAavD,EAAQd,MAElBoE,GAAgB/E,EAASiD,YAC5B8B,EAAgB/E,EAASiD,UACzB+B,EAAahF,EAASiD,UAAYnH,KAAK0E,MAAMnC,KAAM,UAlRpC,IAqRhBvC,KAAK6E,OAASoE,EACdjJ,KAAKkJ,WAAaA,GAGnBV,WAAa,WAEZ,GAAIC,GAAOzI,KACV0I,EAAU,WACLzB,GACHwB,EAAK/D,MAAMtE,IAAK0G,GAEjB2B,EAAK/D,MAAMU,SAAU,eAGvBpF,MAAKgJ,aACLhJ,KAAKgI,WAAWc,IAAK,SAAU9I,KAAK6E,QACpC7E,KAAK0E,MAAMoE,IAAK,SAAU9I,KAAKkJ,YAAajJ,GAAI6G,EAAmB4B,GAE9DzB,GACJyB,EAAQ5G,QAIVsG,gBAAkB,WAMjB,GAAItC,GAAW9F,KAAK0E,MAAMnC,KAAM,aAC/B4G,EAAiBnJ,KAAKgI,WAAWrD,SAASC,IAAMa,EAChD2D,EAAYpJ,KAAK6E,OAAS7E,KAAK0E,MAAMnC,KAAM,UApT5B,IAoT2DoD,EAAQd,OAASiB,EAAW9F,KAAK6E,OAASc,EAAQd,OAASsE,GAAmBxD,EAAQd,OAAS7E,KAAK6E,QAAWsE,CAE1L5C,GAAM8C,SAAWC,UAAYF,GAAalF,EAASkD,QAGpDc,cAAiB,WAChBlI,KAAKgI,WAAWc,IAAK,aAAc,UAAY5E,EAASkD,MAAQ,MAAQlD,EAASmD,QACjFrH,KAAK0E,MAAMoE,IAAK,aAAc,UAAY5E,EAASkD,MAAQ,MAAQlD,EAASmD,SAE7EY,MAAQ,WACP,MAAOjI,MAAKgI,cAILhE,KAAOA","file":"grid.min.js","sourcesContent":["/*\n* debouncedresize: special jQuery event that happens once after a window resize\n*\n* latest version and complete README available on Github:\n* https://github.com/louisremi/jquery-smartresize/blob/master/jquery.debouncedresize.js\n*\n* Copyright 2011 @louis_remi\n* Licensed under the MIT license.\n*/\nvar $event = $.event,\n$special,\nresizeTimeout;\n\n$special = $event.special.debouncedresize = {\n\tsetup: function() {\n\t\t$( this ).on( \"resize\", $special.handler );\n\t},\n\tteardown: function() {\n\t\t$( this ).off( \"resize\", $special.handler );\n\t},\n\thandler: function( event, execAsap ) {\n\t\t// Save the context\n\t\tvar context = this,\n\t\t\targs = arguments,\n\t\t\tdispatch = function() {\n\t\t\t\t// set correct event type\n\t\t\t\tevent.type = \"debouncedresize\";\n\t\t\t\t$event.dispatch.apply( context, args );\n\t\t\t};\n\n\t\tif ( resizeTimeout ) {\n\t\t\tclearTimeout( resizeTimeout );\n\t\t}\n\n\t\texecAsap ?\n\t\t\tdispatch() :\n\t\t\tresizeTimeout = setTimeout( dispatch, $special.threshold );\n\t},\n\tthreshold: 250\n};\n\n// ======================= imagesLoaded Plugin ===============================\n// https://github.com/desandro/imagesloaded\n\n// $('#my-container').imagesLoaded(myFunction)\n// execute a callback when all images have loaded.\n// needed because .load() doesn't work on cached images\n\n// callback function gets image collection as argument\n//  this is the container\n\n// original: MIT license. Paul Irish. 2010.\n// contributors: Oren Solomianik, David DeSandro, Yiannis Chatzikonstantinou\n\n// blank image data-uri bypasses webkit log warning (thx doug jones)\nvar BLANK = 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==';\n\n$.fn.imagesLoaded = function( callback ) {\n\tvar $this = this,\n\t\tdeferred = $.isFunction($.Deferred) ? $.Deferred() : 0,\n\t\thasNotify = $.isFunction(deferred.notify),\n\t\t$images = $this.find('img').add( $this.filter('img') ),\n\t\tloaded = [],\n\t\tproper = [],\n\t\tbroken = [];\n\n\t// Register deferred callbacks\n\tif ($.isPlainObject(callback)) {\n\t\t$.each(callback, function (key, value) {\n\t\t\tif (key === 'callback') {\n\t\t\t\tcallback = value;\n\t\t\t} else if (deferred) {\n\t\t\t\tdeferred[key](value);\n\t\t\t}\n\t\t});\n\t}\n\n\tfunction doneLoading() {\n\t\tvar $proper = $(proper),\n\t\t\t$broken = $(broken);\n\n\t\tif ( deferred ) {\n\t\t\tif ( broken.length ) {\n\t\t\t\tdeferred.reject( $images, $proper, $broken );\n\t\t\t} else {\n\t\t\t\tdeferred.resolve( $images );\n\t\t\t}\n\t\t}\n\n\t\tif ( $.isFunction( callback ) ) {\n\t\t\tcallback.call( $this, $images, $proper, $broken );\n\t\t}\n\t}\n\n\tfunction imgLoaded( img, isBroken ) {\n\t\t// don't proceed if BLANK image, or image is already loaded\n\t\tif ( img.src === BLANK || $.inArray( img, loaded ) !== -1 ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// store element in loaded images array\n\t\tloaded.push( img );\n\n\t\t// keep track of broken and properly loaded images\n\t\tif ( isBroken ) {\n\t\t\tbroken.push( img );\n\t\t} else {\n\t\t\tproper.push( img );\n\t\t}\n\n\t\t// cache image and its state for future calls\n\t\t$.data( img, 'imagesLoaded', { isBroken: isBroken, src: img.src } );\n\n\t\t// trigger deferred progress method if present\n\t\tif ( hasNotify ) {\n\t\t\tdeferred.notifyWith( $(img), [ isBroken, $images, $(proper), $(broken) ] );\n\t\t}\n\n\t\t// call doneLoading and clean listeners if all images are loaded\n\t\tif ( $images.length === loaded.length ){\n\t\t\tsetTimeout( doneLoading );\n\t\t\t$images.unbind( '.imagesLoaded' );\n\t\t}\n\t}\n\n\t// if no images, trigger immediately\n\tif ( !$images.length ) {\n\t\tdoneLoading();\n\t} else {\n\t\t$images.bind( 'load.imagesLoaded error.imagesLoaded', function( event ){\n\t\t\t// trigger imgLoaded\n\t\t\timgLoaded( event.target, event.type === 'error' );\n\t\t}).each( function( i, el ) {\n\t\t\tvar src = el.src;\n\n\t\t\t// find out if this image has been already checked for status\n\t\t\t// if it was, and src has not changed, call imgLoaded on it\n\t\t\tvar cached = $.data( el, 'imagesLoaded' );\n\t\t\tif ( cached && cached.src === src ) {\n\t\t\t\timgLoaded( el, cached.isBroken );\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// if complete is true and browser supports natural sizes, try\n\t\t\t// to check for image status manually\n\t\t\tif ( el.complete && el.naturalWidth !== undefined ) {\n\t\t\t\timgLoaded( el, el.naturalWidth === 0 || el.naturalHeight === 0 );\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// cached images don't fire load sometimes, so we reset src, but only when\n\t\t\t// dealing with IE, or image is complete (loaded) and failed manual check\n\t\t\t// webkit hack from http://groups.google.com/group/jquery-dev/browse_thread/thread/eee6ab7b2da50e1f\n\t\t\tif ( el.readyState || el.complete ) {\n\t\t\t\tel.src = BLANK;\n\t\t\t\tel.src = src;\n\t\t\t}\n\t\t});\n\t}\n\n\treturn deferred ? deferred.promise( $this ) : $this;\n};\n\nvar Grid = (function() {\n\n\t\t// list of items\n\tvar $grid = $( '#og-grid' ),\n\t\t// the items\n\t\t$items = $grid.children( 'li' ),\n\t\t// current expanded item's index\n\t\tcurrent = -1,\n\t\t// position (top) of the expanded item\n\t\t// used to know if the preview will expand in a different row\n\t\tpreviewPos = -1,\n\t\t// extra amount of pixels to scroll the window\n\t\tscrollExtra = 0,\n\t\t// extra margin when expanded (between preview overlay and the next items)\n\t\tmarginExpanded = 10,\n\t\t$window = $( window ), winsize,\n\t\t$body = $( 'html, body' ),\n\t\t// transitionend events\n\t\ttransEndEventNames = {\n\t\t\t'WebkitTransition' : 'webkitTransitionEnd',\n\t\t\t'MozTransition' : 'transitionend',\n\t\t\t'OTransition' : 'oTransitionEnd',\n\t\t\t'msTransition' : 'MSTransitionEnd',\n\t\t\t'transition' : 'transitionend'\n\t\t},\n\t\ttransEndEventName = transEndEventNames[ Modernizr.prefixed( 'transition' ) ],\n\t\t// support for csstransitions\n\t\tsupport = Modernizr.csstransitions,\n\t\t// default settings\n\t\tsettings = {\n\t\t\tminHeight : 500,\n\t\t\tspeed : 350,\n\t\t\teasing : 'ease'\n\t\t};\n\n\tfunction init( config ) {\n\t\t\n\t\t// the settings..\n\t\tsettings = $.extend( true, {}, settings, config );\n\n\t\t// preload all images\n\t\t$grid.imagesLoaded( function() {\n\n\t\t\t// save item´s size and offset\n\t\t\tsaveItemInfo( true );\n\t\t\t// get window´s size\n\t\t\tgetWinSize();\n\t\t\t// initialize some events\n\t\t\tinitEvents();\n\n\t\t} );\n\n\t}\n\n\t// saves the item´s offset top and height (if saveheight is true)\n\tfunction saveItemInfo( saveheight ) {\n\t\t$items.each( function() {\n\t\t\tvar $item = $( this );\n\t\t\t$item.data( 'offsetTop', $item.offset().top );\n\t\t\tif( saveheight ) {\n\t\t\t\t$item.data( 'height', $item.height() );\n\t\t\t}\n\t\t} );\n\t}\n\n\tfunction initEvents() {\n\t\t\n\t\t// when clicking an item, show the preview with the item´s info and large image.\n\t\t// close the item if already expanded.\n\t\t// also close if clicking on the item´s cross\n\t\t$items.on( 'click', 'span.og-close', function() {\n\t\t\thidePreview();\n      resetPlus();\n\t\t\treturn false;\n\t\t} ).children( 'a' ).on( 'click', function(e) {\n      resetPlus();\n\t\t\tvar $item = $( this ).parent();\n      // find the fa and make it minus\n      $item.find('.fa').removeClass('fa-plus');\n      $item.find('.fa').addClass('fa-minus');\n\t\t\t// check if item already opened\n\t\t\tcurrent === $item.index() ? hidePreview() : showPreview( $item );\n\t\t\treturn false;\n\n\t\t} );\n\n\t\t// on window resize get the window´s size again\n\t\t// reset some values..\n\t\t$window.on( 'debouncedresize', function() {\n\t\t\t\n\t\t\tscrollExtra = 0;\n\t\t\tpreviewPos = -1;\n\t\t\t// save item´s offset\n\t\t\tsaveItemInfo();\n\t\t\tgetWinSize();\n\t\t\tvar preview = $.data( this, 'preview' );\n\t\t\tif( typeof preview != 'undefined' ) {\n\t\t\t\thidePreview();\n\t\t\t}\n\n\t\t} );\n\n\t}\n  \n  // reset the plus\n  function resetPlus() {\n    $('.fa').removeClass('fa-minus');\n    $('.fa').addClass('fa-plus');\n  }\n\tfunction getWinSize() {\n\t\twinsize = { width : $window.width(), height : $window.height() };\n\t}\n\n\tfunction showPreview( $item ) {\n\n\t\tvar preview = $.data( this, 'preview' ),\n\t\t\t// item´s offset top\n\t\t\tposition = $item.data( 'offsetTop' );\n\n\t\tscrollExtra = 0;\n\n\t\t// if a preview exists and previewPos is different (different row) from item´s top then close it\n\t\tif( typeof preview != 'undefined' ) {\n\n\t\t\t// not in the same row\n\t\t\tif( previewPos !== position ) {\n\t\t\t\t// if position > previewPos then we need to take te current preview´s height in consideration when scrolling the window\n\t\t\t\tif( position > previewPos ) {\n\t\t\t\t\tscrollExtra = preview.height;\n\t\t\t\t}\n\t\t\t\thidePreview();\n\t\t\t}\n\t\t\t// same row\n\t\t\telse {\n\t\t\t\tpreview.update( $item );\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t\n\t\t}\n\n\t\t// update previewPos\n\t\tpreviewPos = position;\n\t\t// initialize new preview for the clicked item\n\t\tpreview = $.data( this, 'preview', new Preview( $item ) );\n\t\t// expand preview overlay\n\t\tpreview.open();\n\n\t}\n\n\tfunction hidePreview() {\n\t\tcurrent = -1;\n\t\tvar preview = $.data( this, 'preview' );\n\t\tpreview.close();\n\t\t$.removeData( this, 'preview' );\n\t}\n\n\t// the preview obj / overlay\n\tfunction Preview( $item ) {\n\t\tthis.$item = $item;\n\t\tthis.expandedIdx = this.$item.index();\n\t\tthis.create();\n\t\tthis.update();\n\t}\n\n\tPreview.prototype = {\n\t\tcreate : function() {\n\t\t\t// create Preview structure:\n\t\t\tthis.$title = $( '<h3></h3>' );\n\t\t\tthis.$description = $( '<p></p>' );\n\t\t\tthis.$href = $( '<a href=\"#\">Visit website</a>' );\n\t\t\tthis.$details = $( '<div class=\"og-details\"></div>' ).append( this.$title, this.$description, this.$href );\n\t\t\tthis.$loading = $( '<div class=\"og-loading\"></div>' );\n\t\t\tthis.$fullimage = $( '<div class=\"og-fullimg\"></div>' ).append( this.$loading );\n\t\t\tthis.$closePreview = $( '<span class=\"og-close\"></span>' );\n\t\t\tthis.$previewInner = $( '<div class=\"og-expander-inner\"></div>' ).append(this.$fullimage);\n\t\t\tthis.$previewEl = $( '<div class=\"og-expander\"></div>' ).append( this.$closePreview,this.$previewInner );\n\t\t\t// append preview element to the item\n\t\t\tthis.$item.append( this.getEl() );\n\t\t\t// set the transitions for the preview and the item\n\t\t\tif( support ) {\n\t\t\t\tthis.setTransition();\n\t\t\t}\n\t\t},\n\t\tupdate : function( $item ) {\n\n\t\t\tif( $item ) {\n\t\t\t\tthis.$item = $item;\n\t\t\t}\n\t\t\t\n\t\t\t// if already expanded remove class \"og-expanded\" from current item and add it to new item\n\t\t\tif( current !== -1 ) {\n\t\t\t\tvar $currentItem = $items.eq( current );\n\t\t\t\t$currentItem.removeClass( 'og-expanded' );\n\t\t\t\tthis.$item.addClass( 'og-expanded' );\n\t\t\t\t// position the preview correctly\n\t\t\t\tthis.positionPreview();\n\t\t\t}\n\n\t\t\t// update current value\n\t\t\tcurrent = this.$item.index();\n      \n      $.get( \"subpage.html\", function( data ) {\n        $( \".og-expander-inner\" ).html( data );\n  \n      });\n\t\t\t// update preview´s content\n\t\t\t/*var $itemEl = this.$item.children( 'a' ),\n\t\t\t\teldata = {\n\t\t\t\t\thref : $itemEl.attr( 'href' ),\n\t\t\t\t\tlargesrc : $itemEl.data( 'largesrc' ),\n\t\t\t\t\ttitle : $itemEl.data( 'title' ),\n\t\t\t\t\tdescription : $itemEl.data( 'description' )\n\t\t\t\t};\n\n\t\t\tthis.$title.html( eldata.title );\n\t\t\tthis.$description.html( eldata.description );\n\t\t\tthis.$href.attr( 'href', eldata.href );\n\n\t\t\tvar self = this;\n\t\t\t\n\t\t\t// remove the current image in the preview\n\t\t\tif( typeof self.$largeImg != 'undefined' ) {\n\t\t\t\tself.$largeImg.remove();\n\t\t\t}\n\n\t\t\t// preload large image and add it to the preview\n\t\t\t// for smaller screens we don´t display the large image (the media query will hide the fullimage wrapper)\n\t\t\tif( self.$fullimage.is( ':visible' ) ) {\n\t\t\t\tthis.$loading.show();\n\t\t\t\t$( '<img/>' ).load( function() {\n\t\t\t\t\tvar $img = $( this );\n\t\t\t\t\tif( $img.attr( 'src' ) === self.$item.children('a').data( 'largesrc' ) ) {\n\t\t\t\t\t\tself.$loading.hide();\n\t\t\t\t\t\tself.$fullimage.find( 'img' ).remove();\n\t\t\t\t\t\tself.$largeImg = $img.fadeIn( 350 );\n\t\t\t\t\t\tself.$fullimage.append( self.$largeImg );\n\t\t\t\t\t}\n\t\t\t\t} ).attr( 'src', eldata.largesrc );\t\n\t\t\t}*/\n\n\t\t},\n\t\topen : function() {\n\n\t\t\tsetTimeout( $.proxy( function() {\t\n\t\t\t\t// set the height for the preview and the item\n\t\t\t\tthis.setHeights();\n\t\t\t\t// scroll to position the preview in the right place\n\t\t\t\tthis.positionPreview();\n\t\t\t}, this ), 25 );\n\n\t\t},\n\t\tclose : function() {\n\n\t\t\tvar self = this,\n\t\t\t\tonEndFn = function() {\n\t\t\t\t\tif( support ) {\n\t\t\t\t\t\t$( this ).off( transEndEventName );\n\t\t\t\t\t}\n\t\t\t\t\tself.$item.removeClass( 'og-expanded' );\n\t\t\t\t\tself.$previewEl.remove();\n\t\t\t\t};\n\n\t\t\tsetTimeout( $.proxy( function() {\n\n\t\t\t\tif( typeof this.$largeImg !== 'undefined' ) {\n\t\t\t\t\tthis.$largeImg.fadeOut( 'fast' );\n\t\t\t\t}\n\t\t\t\tthis.$previewEl.css( 'height', 0 );\n\t\t\t\t// the current expanded item (might be different from this.$item)\n\t\t\t\tvar $expandedItem = $items.eq( this.expandedIdx );\n\t\t\t\t$expandedItem.css( 'height', $expandedItem.data( 'height' ) ).on( transEndEventName, onEndFn );\n\n\t\t\t\tif( !support ) {\n\t\t\t\t\tonEndFn.call();\n\t\t\t\t}\n\n\t\t\t}, this ), 25 );\n\t\t\t\n\t\t\treturn false;\n\n\t\t},\n\t\tcalcHeight : function() {\n\n\t\t\tvar heightPreview = winsize.height - this.$item.data( 'height' ) - marginExpanded,\n\t\t\t\titemHeight = winsize.height;\n\n\t\t\tif( heightPreview < settings.minHeight ) {\n\t\t\t\theightPreview = settings.minHeight;\n\t\t\t\titemHeight = settings.minHeight + this.$item.data( 'height' ) + marginExpanded;\n\t\t\t}\n\n\t\t\tthis.height = heightPreview;\n\t\t\tthis.itemHeight = itemHeight;\n\n\t\t},\n\t\tsetHeights : function() {\n\n\t\t\tvar self = this,\n\t\t\t\tonEndFn = function() {\n\t\t\t\t\tif( support ) {\n\t\t\t\t\t\tself.$item.off( transEndEventName );\n\t\t\t\t\t}\n\t\t\t\t\tself.$item.addClass( 'og-expanded' );\n\t\t\t\t};\n\n\t\t\tthis.calcHeight();\n\t\t\tthis.$previewEl.css( 'height', this.height );\n\t\t\tthis.$item.css( 'height', this.itemHeight ).on( transEndEventName, onEndFn );\n\n\t\t\tif( !support ) {\n\t\t\t\tonEndFn.call();\n\t\t\t}\n\n\t\t},\n\t\tpositionPreview : function() {\n\n\t\t\t// scroll page\n\t\t\t// case 1 : preview height + item height fits in window´s height\n\t\t\t// case 2 : preview height + item height does not fit in window´s height and preview height is smaller than window´s height\n\t\t\t// case 3 : preview height + item height does not fit in window´s height and preview height is bigger than window´s height\n\t\t\tvar position = this.$item.data( 'offsetTop' ),\n\t\t\t\tpreviewOffsetT = this.$previewEl.offset().top - scrollExtra,\n\t\t\t\tscrollVal = this.height + this.$item.data( 'height' ) + marginExpanded <= winsize.height ? position : this.height < winsize.height ? previewOffsetT - ( winsize.height - this.height ) : previewOffsetT;\n\t\t\t\n\t\t\t$body.animate( { scrollTop : scrollVal }, settings.speed );\n\n\t\t},\n\t\tsetTransition  : function() {\n\t\t\tthis.$previewEl.css( 'transition', 'height ' + settings.speed + 'ms ' + settings.easing );\n\t\t\tthis.$item.css( 'transition', 'height ' + settings.speed + 'ms ' + settings.easing );\n\t\t},\n\t\tgetEl : function() {\n\t\t\treturn this.$previewEl;\n\t\t}\n\t}\n\n\treturn { init : init };\n\n})();"]}